---
title: "Ä†wiczenia 10"
date: "2024-01-15"
output:
  pdf_document: default
  html_document: default
---

```{r, echo=FALSE, warning=FALSE, message=FALSE}
library(tidyverse)
library(caret)
```

### Zadanie 1

```{r}
df <- mtcars
```

```{r}
plot(hclust(dist(scale(df))), frame.plot = TRUE, hang = -1)
rect.hclust(hclust(dist(scale(df))), k = 4)
```

```{r}
cutree(hclust(dist(scale(df)), method = "ward.D2"), k = 4)
```

```{r}
df |>
  scale() |>
  princomp() |>
  predict() |>
  as_tibble() |>
  mutate(group = cutree(hclust(dist(scale(df)), method = "ward.D2"), k = 4) |> factor(),
         name = rownames(mtcars)) |>
  ggplot(aes(col = group, y = Comp.2, x = Comp.1, label = name)) +
  ggrepel::geom_label_repel(max.overlaps = 17) +
  theme_bw()
```

```{r}
cl <- kmeans(scale(df), centers = 4)
```


```{r}
df |>
  scale() |>
  princomp() |>
  predict() |>
  as_tibble() |>
  mutate(group = cl$cluster |> factor(),
         name = rownames(mtcars)) |>
  ggplot(aes(col = group, y = Comp.2, x = Comp.1, label = name)) +
  ggrepel::geom_label_repel(max.overlaps = 17) +
  theme_bw()
```

